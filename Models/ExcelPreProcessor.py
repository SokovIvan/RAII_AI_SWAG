import pandas as pd

# Словарь для сопоставления случаев с критичностью
criticality_mapping = {
    # Критичность 10
    "Человек застрял в лифте": 10,
    "Короткое замыкание внутридомовой электрической сети": 10,
    "Порыв трубы ГВС": 10,
    "Порыв трубы ХВС": 10,
    "Отключение системы электроснабжения": 10,
    "Отопление (Порыв)": 10,
    "ГВС (Порыв трубы)": 10,
    "ХВС (Порыв трубы)": 10,
    "Канализация (аварийные работы)": 10,
    "Электроэнергия (аварийные работы)": 10,
    "Короткое замыкание  внутридомовой электрической сети": 10,

    # Критичность 9
    "Отопление (Отсутствие)": 9,
    "ГВС (Отсутствие)": 9,
    "ХВС (Отсутствие)": 9,
    "Электроэнергия (Отсутствие)": 9,
    "Неисправности во вводно-распределительном устройстве": 9,
    "Неисправности проводки электроснабжения": 9,
    "Неплотность в дымоходах и газоходах и сопряжение их с печами": 9,
    "Трещины и неисправности в печах, дымоходах и газоходах": 9,
    "Отсутствие тяги в дымовых и вентиляционных каналов": 9,
    "Отсутствие тяги в дымовых и вентеляционных каналов": 9,

    # Критичность 8
    "Кровля (Протечка)": 8,
    "Межпанельные швы (Протечка)": 8,
    "Протечки в отдельных местах кровли": 8,
    "Отопление (Нарушение температурного режима)": 8,
    "ГВС (Несоответствие температурных параметров)": 8,
    "ГВС (несоответствие санитарным нормам)": 8,
    "ХВС (несоответствие санитарным нормам)": 8,
    "ХВС (подмес)": 8,
    "Неисправности лифта (Общие проблемы)": 8,
    "Неисправность лифтовой связи": 8,



    # Критичность 7
    "Канализация": 7,
    "Водоотведение (Засор)": 7,
    "Засор канал": 7,
    "Забит мусоропровод": 7,
    "Неисправности мусоропроводов": 7,
    "Повреждения системы водоотвода": 7,
    "Ливневки": 7,
    "Сантехника (замена винтеля)": 7,
    "Течи в водопроводных кранах и в кранах сливных бачков при унитазах": 7,
    "Разбитые стекла, сорванные створки оконных переплетов, форточек, балконных дверных полотен": 7,

    # Критичность 6
    "ГВС": 6,
    "ХВС": 6,
    "ГВС (Слабое давление)": 6,
    "ХВС (Слабое давление)": 6,
    "ГВС (неудовлетворительное состояние труб в квартире)": 6,
    "Отопление (неудовлетворительное состояние труб в квартире)": 6,
    "Отопление (Шум в системе ЦО)": 6,
    "Отопление": 6,
    "Межпанельные швы (Промерзание)": 6,
    "Неисправности освещения в общедомовых помещениях": 6,
    "Неисправности электроплиты": 6,
    "Общестроительные работы": 6,
    "Ремонт дымовых и вентиляционных каналов": 6,
    "Электроэнергия (Замена электрооборудования)": 6,
    "Отключение стояков отопления": 6,

    # Критичность 5
    "Благоустройство": 5,
    "Вывоз мусора": 5,
    "Дверные заполнения (входные двери в подъездах)": 5,
    "Дезинфекция": 5,
    "Домофоны": 5,
    "Монтаж домофона": 5,
    "Монтаж системы домофона в доме": 5,
    "Техническое обслуживание домофона": 5,
    "Установка нового домофона": 5,
    "Придомовая территория": 5,
    "Произвести механизированную уборку территории": 5,
    "Произвести механизирован.уборку терр": 5,
    "произвести механизированную уборку территории": 5,

    # Критичность 4
    "Восстановление связи": 4,
    "Нарушение связи наружной облицовки": 4,
    "Консультации по работе МФЦ": 4,
    "Контрольные показания ХВС\\ГВС": 4,
    "Опломбирование приборов": 4,
    "Опломбирование приборов ГВС": 4,
    "Опломбировка ИПУ": 4,
    "Приборы учета": 4,
    "Проверка ДВК": 4,
    "Проверка канализации": 4,
    "Прочие вопросы": 4,
    "Общие вопросы": 4,
    "Общие вопросы ХВС": 4,

    # Критичность 3
    "Ливнёвки": 3,
    "Газоснабжение": 3,
    "Замена арматуры с/б": 3,
    "ИПУ": 3,
    "Ликвидация воздушных пробок": 3,
    "Плановое обслуживание": 3,
    "Подключение к диспетчеризации": 3,
    "Обслуживание диспетчеризации": 3,
    "Техническое обслуживание": 3,
    "Техническое обслуживание лифтов": 3,
    "Сантехника": 3,

    # Критичность 2

    "Неисправности  освещения в общедомовых помещениях": 2,
    "Кровля (очистка от снега и наледи)": 2,
    "Кровля(очистка от снега и наледи)": 2,
    "Кровля (Ремонт)": 2,
    "Кровля": 2,
    "Сварочные работы": 2,
    "Устранение аварии": 2,

    # Критичность 1
    "Отлов бродячих животных": 1,
    "Центральное отопление": 1,
    "Электроэнергия": 1,
}

# Чтение Excel-файла
file_path = "L.xlsx"
df = pd.read_excel(file_path)

# Проверка названий столбцов
print("Столбцы в файле:", df.columns.tolist())

# Вариант 1: Если столбец называется 'C'
if 'C' in df.columns:
    df["D"] = df["C"].map(criticality_mapping).fillna(0)
# Вариант 2: Если столбец третий (индекс 2)
else:
    df["D"] = df.iloc[:, 2].map(criticality_mapping).fillna(0)

# Сохранение изменений
output_path = "L_proceed.xlsx"
df.to_excel(output_path, index=False)

print("Обработка завершена. Результат сохранен в:", output_path)